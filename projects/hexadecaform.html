so how do I turn the following into a .js element? or should I not do that?
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>HR Hexadecaform + Flow Modal</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    :root{
      --bg:#0e1020;
      --bg2:#131734;
      --panel:#171b33;
      --ink:#e8eef2;
      --muted:#9fb0bf;
      --line:#30365a;
      --accent:#6ae3ff;

      --svc-forms:#107C41;
      --svc-flow:#026CBE;
      --svc-sharepoint:#03787C;
      --svc-outlook:#0078D4;
      --svc-approvals:#605E5C;
      --svc-teams:#6264A7;
      --svc-calendar:#fbbf24;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg2),var(--bg));
      color:var(--ink);
      font:14px system-ui,Segoe UI,Roboto,Arial,sans-serif;
    }
    .wrap{
      max-width:1100px;
      margin:24px auto;
      padding:0 16px 32px;
    }
    h1{
      font-size:22px;
      margin:0 0 4px;
    }
    .sub{
      font-size:13px;
      color:var(--muted);
      margin-bottom:16px;
    }

    .layout{
      display:grid;
      grid-template-columns:minmax(0,1.1fr) minmax(0,0.9fr);
      gap:20px;
    }
    @media(max-width:800px){
      .layout{grid-template-columns:1fr}
    }

    .hub-card,.panel{
      background:var(--panel);
      border-radius:16px;
      border:1px solid #262c4a;
      box-shadow:0 10px 22px rgba(0,0,0,.4);
      padding:14px 16px;
    }

    .hub-title{
      font-weight:600;
      margin-bottom:8px;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:8px;
    }
    .hub-meta{
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }

    .hub-sec-legend{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      font-size:11px;
      margin-bottom:4px;
    }
    .sec-pill{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius:999px;
      background:#141832;
      border:1px solid #262c4a;
      color:var(--muted);
    }
    .sw{
      width:8px;
      height:8px;
      border-radius:999px;
      display:inline-block;
    }
    .sw.sec-es{background:#f97373}
    .sw.sec-pref{background:#22c55e}
    .sw.sec-dev{background:#a855f7}

    /* Diagram hub */
    .hub-shell{
      position:relative;
      aspect-ratio:1 / 1;
      margin-top:4px;
    }
    svg#hub{
      width:100%;
      height:100%;
      display:block;
    }
    .hub-bg{
      fill:#10132a;
      stroke:#272f4f;
      stroke-width:1.4;
    }
    .forms-center{
      fill:#181f3a;
      stroke:#2d375c;
      stroke-width:1.2;
    }
    .forms-label{
      font-size:12px;
      fill:var(--ink);
      font-weight:600;
    }
    .forms-sub{
      font-size:10px;
      fill:var(--muted);
    }

    .spoke{
      stroke:var(--line);
      stroke-width:1.2;
      opacity:.9;
    }
    .node-circle{
      fill:#191f3a;
      stroke:#333c66;
      stroke-width:1.2;
    }
    .node-circle.node-es{stroke:#f97373}
    .node-circle.node-pref{stroke:#22c55e}
    .node-circle.node-dev{stroke:#a855f7}
    .node-circle.active{
      stroke:var(--accent);
      stroke-width:2;
      filter:url(#glow);
    }
    .node-label{
      font-size:9px;
      fill:var(--ink);
      text-anchor:middle;
      pointer-events:none;
    }

    .node-hit{
      fill:transparent;
      cursor:pointer;
    }

    .badge-count{
      font-size:11px;
      padding:2px 8px;
      border-radius:999px;
      background:#1e2442;
      border:1px solid #2c355d;
      color:var(--muted);
    }

    /* STAR panel */
    .panel h2{
      font-size:18px;
      margin:0 0 4px;
    }
    .panel .tagline{
      font-size:12px;
      color:var(--muted);
      margin-bottom:10px;
    }
    .panel .pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-bottom:8px;
    }
    .pill{
      font-size:11px;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid #2c355d;
      background:#151a33;
      display:inline-flex;
      align-items:center;
      gap:4px;
    }
    .sw.forms{background:var(--svc-forms)}
    .sw.flow{background:var(--svc-flow)}
    .sw.sp{background:var(--svc-sharepoint)}
    .sw.mail{background:var(--svc-outlook)}
    .sw.appr{background:var(--svc-approvals)}
    .sw.teams{background:var(--svc-teams)}
    .sw.cal{background:var(--svc-calendar)}

    .panel-cta-row{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-bottom:6px;
    }
    .btn-ghost{
      font-size:11px;
      padding:4px 11px;
      border-radius:999px;
      border:1px solid #2c355d;
      background:#151a33;
      color:var(--ink);
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:6px;
    }
    .btn-ghost small{
      font-size:10px;
      color:var(--muted);
    }
    .btn-ghost[disabled]{
      opacity:.4;
      cursor:default;
    }

    .star-block{
      margin-bottom:8px;
    }
    .star-label{
      font-weight:700;
      font-size:12px;
      margin-bottom:2px;
    }
    .star-text{
      font-size:13px;
      color:var(--ink);
    }

    .hint{
      font-size:12px;
      color:var(--muted);
      margin-top:4px;
    }

    /* modal + flow steps */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.7);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
    }
    .modal{
      background:var(--panel);
      border-radius:16px;
      border:1px solid #262c4a;
      box-shadow:0 18px 45px rgba(0,0,0,.8);
      max-width:780px;
      width:90%;
      max-height:90vh;
      display:flex;
      flex-direction:column;
    }
    .modal-head{
      padding:9px 13px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:8px;
      border-bottom:1px solid #262c4a;
    }
    .modal-title{
      font-size:14px;
      font-weight:600;
    }
    .modal-close{
      border:none;
      background:transparent;
      color:var(--muted);
      cursor:pointer;
      font-size:18px;
      line-height:1;
    }
    .modal-body{
      padding:10px 13px 13px;
      overflow:auto;
    }
    .modal-meta{
      font-size:12px;
      color:var(--muted);
      margin-bottom:6px;
    }
    .flow-legend{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
      margin-bottom:6px;
    }
    .legend-pill{
      display:inline-flex;
      align-items:center;
      gap:5px;
      font-size:10px;
      padding:2px 7px;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      color:var(--muted);
    }

    .stake-badge{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      font-size:10px;
      font-weight:600;
      min-width:22px;
      height:18px;
      padding:0 7px;
      border-radius:999px;
      border:1px solid #2c355d;
      background:#0f1225;
      color:var(--muted);
    }
    .stake-support{background:#111827;}
    .stake-building{background:#1f2937;}
    .stake-training{background:#0b2535;}
    .stake-support-mgr{background:#312e81;}
    .stake-org-mgr{background:#374151;}
    .stake-sup{background:#1f2937;}
    .stake-career{background:#064e3b;}
    .stake-noncareer{background:#7f1d1d;}

    .flow-steps{
      margin-top:4px;
      border-top:1px dashed #1f2937;
      padding-top:6px;
    }
    .flow-step{
      padding:6px 0;
      border-bottom:1px dashed #111827;
    }
    .flow-step:last-child{
      border-bottom:none;
    }
    .flow-step-label{
      font-size:12px;
      margin-bottom:3px;
    }
    .flow-step-meta{
      display:flex;
      flex-wrap:wrap;
      gap:4px;
      align-items:center;
    }
  </style>
</head>
<body>
<div class="wrap">
  <div class="layout">
    <section class="hub-card">
      <div class="hub-title">
        <span>Support Intake System Map</span>
        <span class="badge-count">16 flows</span>
      </div>
      <div class="hub-meta">Center: support_staff_form</div>

      <div class="hub-sec-legend">
        <span class="sec-pill"><span class="sw sec-es"></span> Essential services</span>
        <span class="sec-pill"><span class="sw sec-pref"></span> Preferences and schedule</span>
        <span class="sec-pill"><span class="sw sec-dev"></span> Development and acting</span>
      </div>

      <div class="hub-shell">
        <svg id="hub" viewBox="0 0 400 400" role="img" aria-label="HRSSC Support Intake hub diagram">
          <defs>
            <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
              <feDropShadow dx="0" dy="0" stdDeviation="4" flood-color="#6ae3ff" flood-opacity="0.7"></feDropShadow>
            </filter>
          </defs>
          <circle cx="200" cy="200" r="180" class="hub-bg"></circle>
          <rect x="150" y="165" width="100" height="70" rx="12" class="forms-center"></rect>
          <svg x="180" y="171" width="36" height="34" viewBox="0 0 430 400">
            <path fill="#036c70" d="M430 200v181.7c0 10.1-8.2 18.3-18.3 18.3H118.3c-10.1 0-18.3-8.2-18.3-18.3V200l170-20 160 20z"/>
            <path fill="#37c6d0" d="M118.3 0h293.4C421.8 0 430 8.2 430 18.3V200H100V18.3C100 8.2 108.2 0 118.3 0z"/>
            <path fill="#1a9ba1" d="M280 250h100v100H280z"/>
            <circle cx="330" cy="100" r="60" fill="#1a9ba1"/>
            <circle cx="330" cy="100" r="30" fill="#036c70"/>
            <path d="M221.7 80H100v250h121.7c10.1 0 18.3-8.2 18.3-18.3V98.3c0-10.1-8.2-18.3-18.3-18.3z" opacity=".1"/>
            <path d="M211.7 90H100v250h111.7c10.1 0 18.3-8.2 18.3-18.3V108.3c0-10.1-8.2-18.3-18.3-18.3z" opacity=".2"/>
            <path d="M211.7 90H100v230h111.7c10.1 0 18.3-8.2 18.3-18.3V108.3c0-10.1-8.2-18.3-18.3-18.3z" opacity=".2"/>
            <path d="M201.7 90H100v230h101.7c10.1 0 18.3-8.2 18.3-18.3V108.3c0-10.1-8.2-18.3-18.3-18.3z" opacity=".2"/>
            <linearGradient id="a" x1="38.2184" x2="181.7816" y1="326.3227" y2="77.6773" gradientTransform="matrix(1 0 0 -1 0 402)" gradientUnits="userSpaceOnUse">
              <stop offset="0" stop-color="#058f92"/>
              <stop offset=".5" stop-color="#038489"/>
              <stop offset="1" stop-color="#026d71"/>
            </linearGradient>
            <path fill="url(#a)" d="M18.3 90h183.3c10.1 0 18.3 8.2 18.3 18.3v183.3c0 10.1-8.2 18.3-18.3 18.3H18.3C8.2 310 0 301.8 0 291.7V108.3C0 98.2 8.2 90 18.3 90z"/>
            <path fill="#fff" d="M147.1 159.8H95.5v32.5h48.1v19.3H95.5v48H72.2V140.4h75l-.1 19.4z"/>
          </svg>
          <text x="160" y="220" class="forms-label">Support Intake</text>
        </svg>
      </div>
    </section>

    <aside class="panel" id="panel">
      <h2 id="panelTitle">Pick a flow</h2>
      <div class="tagline" id="panelTagline">Click any spoke to see how that path works in STAR terms.</div>
      <div class="pill-row" id="svcPills"></div>
      <div class="panel-cta-row">
        <button class="btn-ghost" id="openMapBtn" disabled>
          View flow steps
          <small>(per node)</small>
        </button>
      </div>
      <div class="star-block">
        <div class="star-label">S: Situation</div>
        <div class="star-text" id="starS">Multiple HR support tasks were handled ad hoc by email, paper forms, or hallway requests, with no single entry point or audit trail.</div>
      </div>
      <div class="star-block">
        <div class="star-label">T: Task</div>
        <div class="star-text" id="starT">Design a single intake that can safely route many different request types to the right teams and systems.</div>
      </div>
      <div class="star-block">
        <div class="star-label">A: Action</div>
        <div class="star-text" id="starA">Built a central Microsoft Forms intake backed by Power Automate, SharePoint logging, Outlook and Teams notifications, and role checks.</div>
      </div>
      <div class="star-block">
        <div class="star-label">R: Result</div>
        <div class="star-text" id="starR">Created a unified pattern that can be reused across sixteen flows instead of reinventing each workflow in isolation.</div>
      </div>
      <div class="hint" id="panelHint">Hint: start with P4 Termination Offboarding or P2 Reasonable Accommodation Requests if you want to see the most complex branches.</div>
    </aside>
  </div>
</div>
<div class="modal-backdrop" id="flowModalBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="flowModalTitle">
    <div class="modal-head">
      <div class="modal-title" id="flowModalTitle">Flow steps</div>
      <button class="modal-close" id="flowModalClose" aria-label="Close">x</button>
    </div>
    <div class="modal-body">
      <div class="modal-meta" id="flowModalMeta"></div>
      <div class="flow-legend" id="flowLegend"></div>
      <div class="flow-steps" id="flowSteps"></div>
    </div>
  </div>
</div>
<script>
  const STAKEHOLDERS = {
    support_team:{ label:"Support Team", short:"ST", cls:"stake-support" },
    building_services:{ label:"Building Services", short:"BS", cls:"stake-building" },
    training_specialist:{ label:"Training Specialist", short:"TS", cls:"stake-training" },
    support_manager:{ label:"Support Manager", short:"SM", cls:"stake-support-mgr" },
    org_manager:{ label:"Org Manager", short:"OM", cls:"stake-org-mgr" },
    dept_supervisor:{ label:"Department Supervisor", short:"SUP", cls:"stake-sup" },
    career_employee:{ label:"Career Employee", short:"CE", cls:"stake-career" },
    noncareer_employee:{ label:"Non Career Employee", short:"NCE", cls:"stake-noncareer" }
  };

  const SVC_META = {
    forms:{label:"Forms", cls:"forms"},
    flow:{label:"Power Automate", cls:"flow"},
    sharepoint:{label:"SharePoint", cls:"sp"},
    outlook:{label:"Outlook", cls:"mail"},
    approvals:{label:"Approvals", cls:"appr"},
    teams:{label:"Teams", cls:"teams"},
    calendar:{label:"Calendar", cls:"cal"}
  };

  const flows = [
    {
      id:"p1",
      label:"P1 Headset Requests",
      labelLines:["Headset","Requests"],
      short:"Headsets",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","calendar"],
      detail:{
        trigger:"Supervisor submits a headset request for an employee through a single front door form.",
        stakeholders:[
          "career_employee",
          "dept_supervisor",
          "support_team",
          "support_manager"
        ],
        systems:["forms","flow","sharepoint","outlook"],
        steps:[
          {
            id:"H1",
            label:"Supervisor submits headset request form with employee data and justification.",
            system:"forms",
            actor:"dept_supervisor"
          },
          {
            id:"H2",
            label:"Flow validates the supervisor and blocks requests from non authorized roles.",
            system:"flow",
            actor:null
          },
          {
            id:"H3",
            label:"Request logged to the SupportRequests list for inventory tracking.",
            system:"sharepoint",
            actor:"support_team"
          },
          {
            id:"H4",
            label:"Notification email sent to Support Team with a simplified action summary.",
            system:"outlook",
            actor:"support_manager"
          },
          {
            id:"H5",
            label:"Once fulfilled, Support marks the ticket complete and the log updates status.",
            system:"sharepoint",
            actor:"support_team"
          }
        ],
        sla:{
          targetHours:48,
          escalatesTo:"Support Manager"
        }
      },
      star:{
        s:"Employees requested headsets using a mix of emails, drop boxes, and word of mouth, which made tracking inventory and approvals inconsistent.",
        t:"Standardize headset requests so that approvals, inventory assignments, and audit history all live in one place.",
        a:"Routed all headset requests through the intake form, logged them to a SupportRequests list, used a Power Automate flow to pull from a HeadsetInventory list, and sent approval or denial emails with serial numbers and return expectations.",
        r:"Turned headset distribution into a traceable, one click flow with clear approvals and inventory status instead of a pile of sticky notes."
      }
    },
    {
      id:"p2",
      label:"P2 Reasonable Accommodation Requests",
      labelLines:["Accommodation","Requests"],
      short:"RAC",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","calendar"],
      detail:{
        trigger:"Employee or supervisor requests a Reasonable Accommodation packet through the intake form.",
        stakeholders:[
          "career_employee",
          "noncareer_employee",
          "dept_supervisor",
          "support_manager"
        ],
        systems:["forms","flow","sharepoint","outlook","calendar"],
        steps:[
          {
            id:"R1",
            label:"Requester submits Reasonable Accommodation branch with contact and basic need details.",
            system:"forms",
            actor:"career_employee"
          },
          {
            id:"R2",
            label:"Flow logs the request in SupportRequests with an SLA due date for packet return.",
            system:"flow",
            actor:null
          },
          {
            id:"R3",
            label:"Standardized email with legal language and packet attachments sent to requester.",
            system:"outlook",
            actor:"support_manager"
          },
          {
            id:"R4",
            label:"Accommodation specialist notified of new case and due date.",
            system:"outlook",
            actor:"support_manager"
          },
          {
            id:"R5",
            label:"Calendar reminder created for packet due date so follow up is not missed.",
            system:"calendar",
            actor:null
          }
        ],
        sla:{
          targetHours:24,
          escalatesTo:"Support Manager"
        }
      },
      star:{
        s:"Reasonable Accommodation packets were requested in person or by email, with inconsistent language and no clear due date tracking.",
        t:"Make Reasonable Accommodation packet requests consistent, logged, and trackable with clear timelines for both the requester and specialist.",
        a:"Captured Reasonable Accommodation requests via the unified form, created a SupportRequests record with an SLA due date, emailed legal language and packet attachments to the requester, notified the accommodation specialist, and created a shared calendar event for the due date.",
        r:"Reduced accommodation startup friction and provided a predictable path and timeline for an otherwise sensitive and manual process."
      }
    },
    {
      id:"p3",
      label:"P3 Workman's Compensation Requests",
      labelLines:["Workman's","Comp Requests"],
      short:"Workman's comp",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","calendar"],
      star:{
        s:"Workman's Compensation packets were often requested under stress, with manual emailing of forms and no structured tracking of who sent what when.",
        t:"Provide a single, repeatable way to request Workman's Compensation packets and ensure the correct forms and notices go out every time.",
        a:"Used the intake form to capture key injury and contact details, logged each request in SupportRequests, and sent standardized Workman's Compensation packets and instructions via Outlook to the employee and relevant specialists.",
        r:"Improved consistency and traceability of Workman's Compensation packet distribution and reduced back and forth on missing paperwork."
      }
    },
    {
      id:"p4",
      label:"P4 Termination Offboarding",
      labelLines:["Termination","Offboarding"],
      short:"Termination",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","teams","calendar"],
      star:{
        s:"Termination and offboarding actions depended on individual emails and memory to alert TACs, Building Services, IT, and Admin, which made offboarding slow and risky.",
        t:"Create a single termination trigger that notifies all accountable teams, drives required paperwork, and enforces an SLA for cleanup.",
        a:"Built a termination branch that checks supervisor authority, logs a record, notifies TACs, Building Services, IT, Admin and the offboarding mailbox, emails a recoverables checklist, tracks packet upload, and escalates overdue items via calendar events and optional SLA monitoring.",
        r:"Turned offboarding into a coordinated workflow with clear owners, documented steps, and audit ready records instead of scattered emails."
      }
    },
    {
      id:"p5",
      label:"P5 Parking Pass Requests",
      labelLines:["Parking Pass","Requests"],
      short:"Parking",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook"],
      star:{
        s:"Parking pass handling relied on whoever happened to be available, with manual emails and no consistent log of requests.",
        t:"Centralize parking pass requests so they can be tracked, prioritized, and fulfilled without chasing people.",
        a:"Captured parking pass requests in the form, wrote each to a SupportRequests entry or parking list, and sent structured emails to the parking contact with all needed details plus a confirmation back to the requester.",
        r:"Made parking passes a predictable request type instead of a favor you had to catch the right person to get."
      }
    },
    {
      id:"p6",
      label:"P6 Building Services",
      labelLines:["Building","Services"],
      short:"Building svcs",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","teams","calendar"],
      star:{
        s:"Building issues like HVAC, signage, and ergonomics came in via scattered channels, which made prioritization and follow up difficult.",
        t:"Give staff a single route to report building service needs and give Building Services a clean queue.",
        a:"Classified building requests through the intake form, stored them in a structured list, and pushed notifications to the Building Services mailbox or Teams channel with enough metadata to act without extra back and forth.",
        r:"Turned building service requests into a basic ticket queue instead of a random series of hallway complaints."
      }
    },
    {
      id:"p7",
      label:"P7 Conference / Classroom Requests",
      labelLines:["Conference Room","Requests"],
      short:"Rooms",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook","teams","calendar"],
      star:{
        s:"Conference and classroom reservations were managed through email chains and personal calendars, which caused conflicts and missed setups.",
        t:"Standardize how people request space and how the support team tracks reservations and setup tasks.",
        a:"Routed room requests through the intake form, logged requests with times, headcount, and equipment needs, notified training and support managers, and optionally created calendar events or Teams messages for confirmed reservations.",
        r:"Reduced scheduling conflicts and made it much easier for support staff to prep rooms on time."
      }
    },
    {
      id:"p8",
      label:"P8 Supply Orders",
      labelLines:["Supply","Orders"],
      short:"Supplies",
      section:"Essential services",
      services:["forms","flow","sharepoint","outlook"],
      star:{
        s:"Supply orders were emailed or verbally requested, forcing supplies staff to retype orders and chase missing details.",
        t:"Capture supply orders in a structured way and deliver them in a format that can be printed and worked like a pick list.",
        a:"Built a supplies branch that collects pod, department, supervisor, and up to ten line items, composes an Outlook safe HTML table, emails it to the supplies mailbox, sends a copy to the requester, and logs the order in SupportRequests.",
        r:"Cut down on rework for supply staff and gave employees a clear receipt of what they asked for."
      }
    },
    {
      id:"p9",
      label:"P9 Career Preference List",
      labelLines:["Career","Preference"],
      short:"Career prefs",
      section:"Preferences and schedule",
      services:["forms","flow","sharepoint","calendar"],
      star:{
        s:"Career preference lists lived in spreadsheets and email threads, making it hard to see who wanted which assignments.",
        t:"Store career preferences in a structured, queryable format that still starts from a simple form.",
        a:"Let employees submit or update career preferences through the intake, normalized that data, and wrote it into a preference list that HR or support staff could filter by location, role, or seniority.",
        r:"Made it possible to line up career moves against real expressed preferences instead of stale or scattered lists."
      }
    },
    {
      id:"p10",
      label:"P10 Non-Career Preference List",
      labelLines:["Non-Career","Preference"],
      short:"Non-career prefs",
      section:"Preferences and schedule",
      services:["forms","flow","sharepoint","calendar"],
      star:{
        s:"Non career preferences were even more fragmented than career ones, which made filling roles feel reactive instead of guided.",
        t:"Give non career employees the same structured way to express where they want to work and when.",
        a:"Extended the preference pattern to non career staff, captured submissions through the shared form, and stored them in a parallel list keyed by EIN, station, and desired assignment types.",
        r:"Improved fairness and transparency when offering non career placements and opportunities."
      }
    },
    {
      id:"p11",
      label:"P11 Schedule Change Requests",
      labelLines:["Schedule Change","Requests"],
      short:"Schedule changes",
      section:"Preferences and schedule",
      services:["forms","flow","sharepoint","outlook","calendar"],
      star:{
        s:"Schedule change requests were handled through inbox juggling and handwritten notes, with limited visibility into effective dates or conflicts.",
        t:"Create a traceable way to request schedule changes that involves the right supervisors and dates.",
        a:"Captured schedule change requests in the form, logged them with effective dates, notified the supervisor for approval, and optionally created calendar markers or follow up tasks when changes took effect.",
        r:"Reduced missed or misunderstood schedule changes and made it easier to audit who approved what and when."
      }
    },
    {
      id:"p12",
      label:"P12 Preferred Leave Requests",
      labelLines:["Preferred Leave","Requests"],
      short:"Preferred leave",
      section:"Preferences and schedule",
      services:["forms","flow","sharepoint","outlook","calendar"],
      star:{
        s:"Preferred leave periods were tracked in a mix of spreadsheets and emails, which made conflicts and overlaps hard to spot.",
        t:"Collect preferred leave windows in one place so planning and approvals can be done with a full view of demand.",
        a:"Let employees submit preferred leave windows via the intake form, wrote them into a structured list, and notified supervisors so they could approve, deny, or negotiate with full team data.",
        r:"Made leave planning less emotional and more data driven by giving leaders a consolidated view of requests."
      }
    },
    {
      id:"p13",
      label:"P13 Trainer Interest Application",
      labelLines:["Trainer Interest","Application"],
      short:"Trainer interest",
      section:"Development and acting",
      services:["forms","flow","sharepoint","outlook"],
      star:{
        s:"Trainer or subject matter expert interest was often invisible until someone was tapped informally, which limited who got development opportunities.",
        t:"Give staff a visible, fair way to raise their hand for training or SME work and capture that interest for future needs.",
        a:"Captured trainer interest in the intake, recorded it in a development focused list, and notified training or support leads when new candidates appeared in key domains.",
        r:"Created a living pool of potential trainers instead of relying on memory or who spoke up loudest."
      }
    },
    {
      id:"p14",
      label:"P14 A/ SUPV Application",
      labelLines:["A/ SUPV","Application"],
      short:"A/ SUPV",
      section:"Development and acting",
      services:["forms","flow","sharepoint","outlook"],
      star:{
        s:"Acting supervisor opportunities were often offered to a small circle of known people, leaving others unsure how to be considered.",
        t:"Formalize how people express interest in acting supervisor roles and how that interest is tracked.",
        a:"Used the intake to gather acting supervisor applications, logged them with qualifications and preferences, and notified the responsible supervisors or managers when new candidates matched open needs.",
        r:"Improved transparency into who wanted leadership development and gave managers a better bench to pull from."
      }
    },
    {
      id:"p15",
      label:"P15 A/ Support Application",
      labelLines:["A/ Support","Application"],
      short:"A/ Support",
      section:"Development and acting",
      services:["forms","flow","sharepoint","outlook"],
      star:{
        s:"Support side acting roles were filled informally, which made it hard to see who had already stepped up or who wanted a chance.",
        t:"Track interest in acting support roles with the same structure used for other development paths.",
        a:"Extended the acting pattern to support assignments, capturing interest and key skills in a list and alerting support leaders when they needed coverage.",
        r:"Turned acting support work into a managed development opportunity instead of a scramble."
      }
    },
    {
      id:"p16",
      label:"P16 A/ Systems Application",
      labelLines:["A/ Systems","Application"],
      short:"A/ Systems",
      section:"Development and acting",
      services:["forms","flow","sharepoint","outlook","teams"],
      star:{
        s:"Systems focused acting roles demanded specific skills but there was no structured way to see who was both interested and qualified.",
        t:"Collect and surface interest in systems oriented acting roles so that project and systems work has a proper bench.",
        a:"Captured systems acting interest via the intake, logged tooling and system experience in a list, and used notifications to route candidates to the systems or project owners when opportunities came up.",
        r:"Made it easier to staff systems work with people who had both interest and capability, instead of grabbing whoever was nearby."
      }
    }
  ];

  const SVG_NS = "http://www.w3.org/2000/svg";

  function buildSvcPills(services){
    const row = document.getElementById("svcPills");
    row.innerHTML = "";
    services.forEach(s=>{
      const meta = SVC_META[s];
      if(!meta) return;
      const pill = document.createElement("div");
      pill.className = "pill";
      const dot = document.createElement("span");
      dot.className = "sw " + meta.cls;
      pill.appendChild(dot);
      const txt = document.createElement("span");
      txt.textContent = meta.label;
      pill.appendChild(txt);
      row.appendChild(pill);
    });
  }

  function sectionKey(section){
    if(section.indexOf("Essential") === 0) return "es";
    if(section.indexOf("Preferences") === 0) return "pref";
    if(section.indexOf("Development") === 0) return "dev";
    return "es";
  }

  (function buildHub(){
    const svg = document.getElementById("hub");
    if(!svg) return;
    const centerX = 200;
    const centerY = 200;
    const innerRadius = 80;
    const outerRadius = 150;

    flows.forEach((flow, index)=>{
      const angle = (index / flows.length) * Math.PI * 2 - Math.PI / 2;
      const x1 = centerX + innerRadius * Math.cos(angle);
      const y1 = centerY + innerRadius * Math.sin(angle);
      const x2 = centerX + outerRadius * Math.cos(angle);
      const y2 = centerY + outerRadius * Math.sin(angle);

      const spoke = document.createElementNS(SVG_NS,"line");
      spoke.setAttribute("x1", x1);
      spoke.setAttribute("y1", y1);
      spoke.setAttribute("x2", x2);
      spoke.setAttribute("y2", y2);
      spoke.setAttribute("class","spoke");
      svg.appendChild(spoke);

      const g = document.createElementNS(SVG_NS,"g");
      g.setAttribute("data-id", flow.id);

      const secCls = "node-" + sectionKey(flow.section);

      const circle = document.createElementNS(SVG_NS,"circle");
      circle.setAttribute("cx", x2);
      circle.setAttribute("cy", y2);
      circle.setAttribute("r", 16);
      circle.setAttribute("class","node-circle " + secCls);
      circle.setAttribute("data-role","circle");
      g.appendChild(circle);

      const hit = document.createElementNS(SVG_NS,"circle");
      hit.setAttribute("cx", x2);
      hit.setAttribute("cy", y2);
      hit.setAttribute("r", 22);
      hit.setAttribute("class","node-hit");
      g.appendChild(hit);

      const label = document.createElementNS(SVG_NS,"text");
      label.setAttribute("x", x2);
      label.setAttribute("y", y2 - 30);
      label.setAttribute("text-anchor","middle");
      label.setAttribute("class","node-label");

      const core = flow.label.replace(/^P\d+\s+/, "");
      let lines;
      if (Array.isArray(flow.labelLines) && flow.labelLines.length > 0) {
        lines = flow.labelLines;
      } else {
        const parts = core.split(" ");
        if (parts.length > 1) {
          const last = parts.pop();
          lines = [parts.join(" "), last];
        } else {
          lines = [core];
        }
      }

      lines.forEach((txt, i) => {
        const tspan = document.createElementNS(SVG_NS, "tspan");
        tspan.setAttribute("x", x2);
        tspan.setAttribute("dy", i === 0 ? "0" : "12");
        tspan.textContent = txt;
        label.appendChild(tspan);
      });

      g.appendChild(label);
      svg.appendChild(g);

      g.addEventListener("click", function(){
        selectFlow(flow.id);
      });
    });
  })();

  function renderStakeBadge(key){
    const meta = STAKEHOLDERS[key];
    if(!meta) return null;
    const span = document.createElement("span");
    span.className = "stake-badge " + meta.cls;
    span.textContent = meta.short;
    span.title = meta.label;
    return span;
  }

  function renderStep(step){
    const wrap = document.createElement("div");
    wrap.className = "flow-step";

    const label = document.createElement("div");
    label.className = "flow-step-label";
    label.textContent = step.label;
    wrap.appendChild(label);

    const metaRow = document.createElement("div");
    metaRow.className = "flow-step-meta";

    const svc = SVC_META[step.system];
    if(svc){
      const pill = document.createElement("div");
      pill.className = "pill";
      const dot = document.createElement("span");
      dot.className = "sw " + svc.cls;
      pill.appendChild(dot);
      const txt = document.createElement("span");
      txt.textContent = svc.label;
      pill.appendChild(txt);
      metaRow.appendChild(pill);
    }

    if(step.actor){
      const badge = renderStakeBadge(step.actor);
      if(badge){
        metaRow.appendChild(badge);
      }
    }

    wrap.appendChild(metaRow);
    return wrap;
  }

  let currentId = null;
  let currentFlow = null;

  function openFlowModal(){
    if(!currentFlow || !currentFlow.detail) return;
    const backdrop = document.getElementById("flowModalBackdrop");
    const titleEl = document.getElementById("flowModalTitle");
    const metaEl = document.getElementById("flowModalMeta");
    const legendEl = document.getElementById("flowLegend");
    const stepsEl = document.getElementById("flowSteps");
    if(!backdrop || !titleEl || !metaEl || !legendEl || !stepsEl) return;

    titleEl.textContent = currentFlow.label + " flow";
    if(currentFlow.detail.sla){
      metaEl.textContent = currentFlow.short + " 路 " + currentFlow.section + " 路 SLA: " + currentFlow.detail.sla.targetHours + "h";
    } else {
      metaEl.textContent = currentFlow.short + " 路 " + currentFlow.section;
    }

    legendEl.innerHTML = "";
    const sysSeen = new Set();
    (currentFlow.detail.systems || []).forEach(key => {
      const meta = SVC_META[key];
      if(!meta || sysSeen.has(key)) return;
      sysSeen.add(key);
      const lp = document.createElement("div");
      lp.className = "legend-pill";
      const dot = document.createElement("span");
      dot.className = "sw " + meta.cls;
      lp.appendChild(dot);
      const txt = document.createElement("span");
      txt.textContent = meta.label;
      lp.appendChild(txt);
      legendEl.appendChild(lp);
    });

    const stakeSeen = new Set();
    (currentFlow.detail.stakeholders || []).forEach(key => {
      if(stakeSeen.has(key)) return;
      stakeSeen.add(key);
      const badge = renderStakeBadge(key);
      if(badge){
        legendEl.appendChild(badge);
      }
    });

    stepsEl.innerHTML = "";
    (currentFlow.detail.steps || []).forEach(step => {
      stepsEl.appendChild(renderStep(step));
    });

    backdrop.style.display = "flex";
    backdrop.setAttribute("aria-hidden","false");
  }

  function closeFlowModal(){
    const backdrop = document.getElementById("flowModalBackdrop");
    if(!backdrop) return;
    backdrop.style.display = "none";
    backdrop.setAttribute("aria-hidden","true");
  }

  function selectFlow(id){
    const flow = flows.find(f => f.id === id);
    if(!flow) return;

    currentId = id;
    currentFlow = flow;

    document.querySelectorAll(".node-circle").forEach(c=>{
      c.classList.remove("active");
    });
    const activeCircle = document.querySelector('g[data-id="' + id + '"] circle[data-role="circle"]');
    if(activeCircle){
      activeCircle.classList.add("active");
    }

    document.getElementById("panelTitle").textContent = flow.label;
    document.getElementById("panelTagline").textContent = flow.short + " 路 " + flow.section;
    document.getElementById("starS").textContent = flow.star.s;
    document.getElementById("starT").textContent = flow.star.t;
    document.getElementById("starA").textContent = flow.star.a;
    document.getElementById("starR").textContent = flow.star.r;

    if(flow.detail && flow.detail.trigger){
      document.getElementById("panelHint").textContent = "Trigger: " + flow.detail.trigger;
    } else {
      document.getElementById("panelHint").textContent = "Services touched: " + flow.services.join(", ") + ".";
    }

    buildSvcPills(flow.services);

    const mapBtn = document.getElementById("openMapBtn");
    if(mapBtn){
      mapBtn.disabled = !flow.detail;
    }
  }

  (function selfTest(){
    if(!Array.isArray(flows) || flows.length !== 16){
      console.warn("Hexadecaform sanity check: expected 16 flows, got", Array.isArray(flows) ? flows.length : typeof flows);
    }
  })();

  document.addEventListener("DOMContentLoaded", function(){
    const mapBtn = document.getElementById("openMapBtn");
    if(mapBtn){
      mapBtn.addEventListener("click", function(){
        if(!mapBtn.disabled){
          openFlowModal();
        }
      });
    }

    const closeBtn = document.getElementById("flowModalClose");
    const backdrop = document.getElementById("flowModalBackdrop");
    if(closeBtn){
      closeBtn.addEventListener("click", closeFlowModal);
    }
    if(backdrop){
      backdrop.addEventListener("click", function(e){
        if(e.target === backdrop){
          closeFlowModal();
        }
      });
    }

    // default selection
    selectFlow("p1");
  });
</script>